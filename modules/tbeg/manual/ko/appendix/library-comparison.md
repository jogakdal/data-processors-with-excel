# 별첨: 타 라이브러리 비교

Excel 보고서 생성 라이브러리를 선택할 때 참고할 수 있도록, TBEG과 유사한 템플릿 기반 라이브러리인 JXLS와 ExcelReportGenerator(ERG)를 비교합니다.

---

## 1. 비교 대상

### JXLS

JVM 생태계에서 가장 널리 알려진 템플릿 기반 Excel 생성 라이브러리입니다. Apache POI 기반으로 동작하며, **엑셀 셀의 노트(Comment)** 에 명령어를 작성하여 보고서를 구성합니다.

- **플랫폼**: JVM (Java 17)
- **Excel 엔진**: Apache POI
- **라이선스**: Apache License 2.0
- **GitHub**: [jxlsteam/jxls](https://github.com/jxlsteam/jxls)

### ExcelReportGenerator (ERG)

.NET 기반의 Excel 보고서 생성 라이브러리입니다. ClosedXML을 기반으로 동작하며, Named Range와 "패널" 계층 구조를 통해 보고서를 구성합니다.

- **플랫폼**: .NET Standard 2.0
- **Excel 엔진**: ClosedXML (OpenXML 래퍼)
- **라이선스**: MIT
- **GitHub**: [traf72/excel-report-generator](https://github.com/traf72/excel-report-generator)

### TBEG (Template-Based Excel Generator)

Kotlin/JVM 기반의 Excel 보고서 생성 라이브러리입니다. Excel 템플릿 셀에 마커를 직접 작성하는 방식으로, 디자이너가 만든 Excel 양식을 그대로 활용하면서 데이터만 바인딩하면 됩니다.

- **플랫폼**: JVM (Kotlin/Java)
- **Excel 엔진**: Apache POI (XSSF/SXSSF)
- **패키지**: `io.github.jogakdal:tbeg`

---

## 2. 한눈에 보는 비교

| 항목 | JXLS | ERG | TBEG |
|------|------|-----|------|
| **템플릿 설계** | 셀 노트에 명령어 작성 | Named Range + 코드에서 패널 구성 | 셀에 마커 작성만으로 완료 |
| **이미지 삽입** | 기본 지원 | 미지원 | 위치, 크기, 비율 등 다양한 옵션 |
| **차트** | 미지원 | 미지원 | 데이터 확장 시 차트 자동 반영 |
| **피벗 테이블** | Excel 새로고침에 의존 | 미지원 | 데이터 확장 시 피벗 자동 반영 |
| **수식 자동 조정** | 지원 | 기본 수준 | 모든 참조 방식 지원, 데이터 확장 시 자동 반영 |
| **대용량 처리** | 스트리밍 지원 (제약 있음) | 전체 메모리 로드 | 스트리밍 모드 (10만 행 이상) |
| **비동기 처리** | 미지원 | 미지원 | 백그라운드 생성, 진행률 확인, 취소 |
| **빌트인 집계** | GroupSum | Sum, Avg, Count, Min, Max | Excel 수식 활용 |
| **그룹화** | groupBy (each 속성) | GroupBy (셀 자동 병합) | 데이터 사전 그룹화 필요 |
| **Spring Boot** | 미지원 | 미지원 | 의존성 추가만으로 바로 사용 |

---

## 3. 항목별 상세 비교

### 3.1 템플릿 설계 방식

| | ERG | JXLS | TBEG |
|---|---|---|---|
| **마커 위치** | 코드에서 패널 트리 구성 | 셀 노트(Comment)에 작성 | 셀에 직접 작성 |
| **템플릿만으로 구조 파악** | 불가 (코드 필요) | 어려움 (노트를 열어봐야 함) | 가능 (셀에 마커가 보임) |
| **레이아웃 변경 시** | 코드 수정 필요 | 노트 수정 필요 | 템플릿 파일만 수정 |

---

### 3.2 수식 처리

| | ERG | JXLS | TBEG |
|---|---|---|---|
| **수식 범위 확장** | 기본적인 행 이동 수준 | 지원 (Standard/Fast 모드 트레이드오프) | 모든 참조 방식 지원 |
| **수식 내 변수** | 미지원 | `$[...]` 별도 문법 + 추가 호출 필요 | `${변수명}` 동일 문법 |
| **cross-sheet 수식** | 미지원 | 지원 | 지원 |

---

### 3.3 대용량 처리

| | ERG | JXLS | TBEG |
|---|---|---|---|
| **스트리밍** | 미지원 (전체 메모리 로드) | 지원 (기본 비활성, 제약 있음) | 기본 활성 (10만 행 이상 처리) |
| **비동기 처리** | 미지원 | 미지원 | 백그라운드 생성, 진행률, 취소 |

---

### 3.4 레이아웃 보존

| | ERG | JXLS | TBEG |
|---|---|---|---|
| **병합 셀** | 부분 지원 | 지원 (동적 병합 제약) | 지원 |
| **조건부 서식** | 부분 지원 | 부분 지원 (다중 시트 제약) | 지원 |
| **빈 컬렉션 대체** | 미지원 (빈 영역 노출) | `jx:if` + `jx:each` 조합 필요 | `empty` 파라미터로 지정 |

---

### 3.5 프레임워크 통합

| | ERG | JXLS | TBEG |
|---|---|---|---|
| **Spring Boot** | 미지원 | 미지원 | 의존성 추가만으로 바로 사용 |

---

## 4. 타 라이브러리의 고유 강점

공정한 비교를 위해, 각 라이브러리가 가진 고유한 강점도 살펴보겠습니다.

### JXLS

**그룹화와 집계**

`jx:each`의 `groupBy` 속성과 `GroupSum` 클래스로 데이터 그룹화와 집계를 선언적으로 처리할 수 있습니다.

TBEG에서는 Excel 수식(`=SUM()`, `=AVERAGE()` 등)으로 동일한 결과를 얻을 수 있으며, 이 방식은 **Excel에서 직접 계산 로직을 확인하고 검증할 수 있다**는 장점이 있습니다.

**조건부 렌더링**

`jx:if` 명령어로 조건에 따라 영역을 표시하거나 숨길 수 있습니다. TBEG에서는 DataProvider에서 데이터를 사전 가공하여 동일한 결과를 달성할 수 있습니다.

**다중 시트 자동 생성**

`multisheet` 속성으로 컬렉션의 각 항목을 별도의 시트로 자동 생성할 수 있습니다.

### ERG

**빌트인 집계 함수**

Sum, Avg, Count, Min, Max와 사용자 정의 집계 함수를 패널에 내장하고 있습니다.

**자동 셀 병합**

GroupBy로 동일한 값을 가진 셀을 자동으로 병합합니다. 부서별 직원 목록처럼 같은 부서명이 반복되는 경우에 유용합니다.

**패널 계층 구조**

Parent/Children 패널 트리로 복잡한 중첩 보고서를 구성할 수 있으며, 패널별 Before/After 렌더링 훅으로 세밀한 제어가 가능합니다.

---

## 5. 종합 비교표

### 템플릿 & 데이터 바인딩

| 기능 | JXLS | ERG | TBEG |
|------|:----:|:---:|:----:|
| 셀 변수 치환 | O | O | O |
| 수식 내 변수 치환 | O | X | O |
| 도형/차트 제목 변수 치환 | X | X | O |
| 머리글/바닥글 변수 치환 | △ | X | O |
| 코드 없는 템플릿 설계 | O | X | O |
| 마커 가시성 | △ | X | O |

### 반복(Repeat) 처리

| 기능 | JXLS | ERG | TBEG |
|------|:----:|:---:|:----:|
| 수직 방향 반복 | O | O | O |
| 수평 방향 반복 | O | O | O |
| 다중 행/열 반복 | O | O | O |
| 같은 시트에 여러 반복 영역 | O | O | O |
| cross-sheet 반복 | X | X | O |
| 빈 컬렉션 대체 콘텐츠 | △ | X | O |
| 빌트인 그룹화 | O | O | X |
| 조건부 렌더링 | O | X | X |
| 다중 시트 자동 생성 | O | X | X |

### 수식 & 서식

| 기능 | JXLS | ERG | TBEG |
|------|:----:|:---:|:----:|
| 기본 수식 보존 | O | O | O |
| 수식 범위 자동 확장 | O | X | O |
| 절대/상대/혼합 참조 처리 | O | △ | O |
| cross-sheet 수식 조정 | O | X | O |
| 병합 셀 자동 복제 | O | △ | O |
| 조건부 서식 자동 복제 | △ | △ | O |
| 숫자 서식 자동 적용 | X | X | O |

### 고급 기능

| 기능 | JXLS | ERG | TBEG |
|------|:----:|:---:|:----:|
| 이미지 삽입 | O | X | O |
| 차트 지원 | X | X | O |
| 피벗 테이블 지원 | △ | X | O |
| 문서 메타데이터 | X | X | O |
| 파일 암호화 | X | X | O |
| 빌트인 집계 함수 | O | O | X |
| 국제화 (리소스 번들) | O | X | O |

### 성능 & 확장성

| 기능 | JXLS | ERG | TBEG |
|------|:----:|:---:|:----:|
| 스트리밍 모드 | △ | X | O |
| 비동기 처리 | X | X | O |
| 진행률 콜백 | X | △ | O |
| 작업 취소 | X | X | O |
| 지연 로딩 (DataProvider) | X | X | O |

### 프레임워크 통합

| 기능 | JXLS | ERG | TBEG |
|------|:----:|:---:|:----:|
| Spring Boot AutoConfiguration | X | X | O |
| 설정 파일(yml/properties) 연동 | X | X | O |
| Java 호환 API | O | X | O |

> [!TIP]
> **범례**: O = 지원, △ = 부분 지원 또는 제약 있음, X = 미지원

---

## 6. 적합한 선택 가이드

### TBEG이 적합한 경우

- **디자이너가 만든 Excel 양식**을 그대로 활용해야 할 때
- 보고서에 **이미지, 차트, 피벗 테이블**이 포함될 때
- **수식 기반의 자동 계산**이 중요한 보고서일 때
- **수만~수십만 행**의 대용량 데이터를 안정적으로 처리해야 할 때
- **비동기 처리**와 **진행률 확인**이 필요할 때
- **Spring Boot** 환경에서 간편하게 통합하고 싶을 때
- 템플릿 변경 시 **코드 수정 없이** 대응하고 싶을 때

### JXLS가 적합한 경우

- 조건부 렌더링(`jx:if`)이 핵심 요구사항일 때
- **다중 시트 자동 생성**이 필요할 때
- 텍스트 데이터 중심의 보고서일 때

### ERG가 적합한 경우

- **.NET** 기반 프로젝트일 때
- 코드에서 **집계와 그룹화**를 선언적으로 처리하고 싶을 때
- **패널 트리**로 복잡한 중첩 구조를 코드 레벨에서 제어해야 할 때

> [!TIP]
> TBEG은 빌트인 집계 기능 대신 **Excel 수식을 활용**하는 접근을 취합니다. `=SUM()`, `=AVERAGE()` 등의 수식을 템플릿에 미리 배치하면 데이터 확장 시 범위가 자동으로 조정되어, **Excel에서 직접 계산 로직을 확인하고 검증할 수 있다**는 장점이 있습니다.
